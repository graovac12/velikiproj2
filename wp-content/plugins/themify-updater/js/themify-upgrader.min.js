'use strict';var ThemifyUpdater;
(function(d,n,g){ThemifyUpdater={showAlert:function(){d(".themify_updater_alert").addClass("busy").fadeIn(800)},hideAlert:function(a){a="error"===a?"error":"done";d(".themify_updater_alert").removeClass("busy").addClass(a).delay(800).fadeOut(800,function(){d(this).removeClass(a)})},events:function(){d("#themify-updater-search .clear-search").on("click",function(){d(this).prev().val("");d(g).trigger("themify_update_promo")});d("#themify-updater-search .promo-search").on("input",function(a){a=d(this);
var e=a.val().toLowerCase();a=a.siblings(".clear-search");""!=e&&0<d(".theme-list li").length&&d(".theme-list li").filter(function(){var h=d(this);1==h.is(":visible")&&-1<h.find(".theme-title h3").text().toLowerCase().indexOf(e)?h.show():h.hide().parent().append(h)});""==e?a.click().hide():a.show()});ThemifyUpdater.updateThemeBtn();d("#wpbody").on("click","a.themify-updater",function(a){a.preventDefault();if(d(this).hasClass("themify-updater-stop"))d(this).closest(".notifications").after('<div id="themifyUpdateRrror" class="notice notice-error is-dismissible">'+
themify_upgrader_license.error_message+"</div>");else if(confirm(themify_upgrader.check_backup)){a=d(this);var e=a.closest(".notifications"),h=a.data("update_type"),c={slug:a.data("plugin"),action:h.substring(0,h.length-1),_ajax_nonce:a.data("nonce"),_fs_nonce:"",username:"",password:"",connection_type:"",public_key:"",private_key:""};"update-plugins"===h&&(c.plugin=a.data("base"));d.ajax({url:ajaxurl,type:"POST",data:c,beforeSend:function(){ThemifyUpdater.showAlert()},success:function(b){b="string"===
typeof b?JSON.parse(b):b;b.success?(ThemifyUpdater.hideAlert(),setTimeout(function(){location.reload()},1500)):(ThemifyUpdater.hideAlert("error"),0<e.siblings("#themifyUpdateRrror").length&&e.siblings("#themifyUpdateRrror").remove(),e.after('<div id="themifyUpdateRrror" class="notice notice-error is-dismissible">'+b.data.errorMessage+"</div>"))},error:function(){ThemifyUpdater.hideAlert("error")}})}});d(".themify_updater_changelogs").on("click",function(a){a.preventDefault();a=d(this).data("changelog");
d(".themify-updater-promt-box .show-error").hide();d(".themify_updater_alert").addClass("busy").fadeIn(300);d(".themify_updater_promt_overlay,.themify-updater-promt-box").fadeIn(300);d('<iframe src="'+a+'" />').on("load",function(){d(".themify_updater_alert").removeClass("busy").fadeOut(300)}).prependTo(".themify-updater-promt-box");d(".themify-updater-promt-box").addClass("show-changelog");d(".themify_updater_promt_overlay").one("click",function(e){d(this).fadeOut(300);d(".themify-updater-promt-box").fadeOut(300).find("iframe").remove()})});
d(".notifications .notification-group span:first-child").on("click",function(a){a.preventDefault();d(this).siblings().slideToggle()});d(g).on("themify_updater_init_batch",function(){0<g.getElementsByClassName("themify-updater-batch-wrap").length&&ThemifyUpdater.initBatchInstaller()})},initBatchInstaller:function(){var a=g.querySelector(".themify-updater-batch-install"),e=a.querySelector(".themify-updater-batch-install .batch-install-enable");a.style.display="block";e.addEventListener("change",function(){g.body.classList.toggle("themify-updater-batch-mode")});
a.querySelector(".themify-updater-batch-install-btn").addEventListener("click",function(){const c=g.querySelectorAll(".themify-updater-batch-checkbox:checked");var b=c.length;if(0===b)alert("Please select at least on item to install.");else{var f={};for(--b;-1<b;b--){let k=this.dataset.update+"?action="+c[b].dataset.action+"-"+this.dataset.type+"&"+this.dataset.type+"="+c[b].dataset.slug+"&_wpnonce="+c[b].dataset.nonce;if("upgrade"===c[b].dataset.action){let l=c[b].parentNode.nextElementSibling;const m=
l&&l.value?l.value:"";k+="&themify_theme_downgrade=1&version="+(l.selectedOptions[0].hasAttribute("data-latest")?"":m);""!==m&&(c[b].dataset.title=c[b].dataset.title+" "+m)}f[c[b].dataset.title]=k}ThemifyUpdater.bulkInstall(f,ThemifyUpdater.initModal())}});a=g.querySelector(".batch-install-all input");e=g.querySelectorAll(".theme-post:not([style^=display]) .themify-updater-batch-checkbox");const h=function(){this.closest(".themify-updater-batch-wrap").classList.toggle("batch-checked")};for(let c=
e.length-1;-1<c;c--)e[c].addEventListener("change",h);a.addEventListener("change",function(){const c=this.checked;var b=g.querySelectorAll(".theme-post:not([style^=display]) .themify-updater-batch-checkbox");for(let f=b.length-1;-1<f;f--){b[f].checked=c;const k=b[f].closest(".themify-updater-batch-wrap").classList;c?k.add("batch-checked"):k.remove("batch-checked")}if(b=g.querySelector(".plugin-category .active"))c?b.dataset.checked=c:b.dataset.checked&&delete b.dataset.checked})},bulkInstall:function(a,
e){const h=Object.keys(a),c=g.createElement("li"),b=g.createElement("span");c.appendChild(g.createTextNode(themify_upgrader.installing));b.className="themify-updater-batch-name";b.innerText=h[0]+" ";c.appendChild(b);c.className="themify-updater-batch-installing";e.appendChild(c);fetch(a[h[0]],{headers:new Headers({"X-Requested-With":"XMLHttpRequest"})}).then(f=>f.text()).then(function(f){f=(new DOMParser).parseFromString(f,"text/html").querySelector(".wrap a[href*=activate]");c.innerHTML="";c.appendChild(b);
if(!e.dataset.activate&&f){var k=g.createElement("a");k.href=f.href;k.className="themify-updater-batch-activate";k.innerText=themify_upgrader.activate_lnk;c.appendChild(k)}else c.appendChild(g.createTextNode(f?themify_upgrader.installed:themify_upgrader.activated));c.classList.remove("themify-updater-batch-installing");c.classList.add("themify-updater-batch-installed");delete a[h[0]];if(1<h.length)ThemifyUpdater.bulkInstall(a,e);else{e.parentNode.querySelector(".themify-updater-modal-loading").remove();
k=e.nextElementSibling;if(e.dataset.activate&&f){const l=g.createElement("a");l.className="themify-updater-modal-activate themify-updater-button";l.href=f.href;l.innerText=themify_upgrader.activate;k.appendChild(l)}f=g.createElement("div");f.className="themify-updater-modal-done themify-updater-button";f.setAttribute("onclick","location.reload()");f.innerText=themify_upgrader.done;k.appendChild(f)}}).catch(function(f){console.warn("Update error.",f)})},initModal:function(a){g.getElementById("wpbody-content").style.pointerEvents=
"none";g.body.style.overflow="hidden";const e=g.createElement("div");e.className="themify-updater-modal tf_scrollbar";const h=g.createElement("ul");h.className="themify-updater-bulk-list tf_scrollbar";!0===a&&(h.dataset.activate=!0);e.appendChild(h);a=g.createElement("div");a.className="themify-updater-modal-loading";e.appendChild(a);a=g.createElement("div");a.className="themify-updater-modal-btns";e.appendChild(a);g.body.appendChild(e);e.addEventListener("click",function(c){const b=c.target;"A"===
b.tagName&&b.classList.contains("themify-updater-batch-activate")&&(c.preventDefault(),c.stopPropagation(),b.dataset.loading||(ThemifyUpdater.showAlert(),fetch(b.href,{headers:new Headers({"X-Requested-With":"XMLHttpRequest"})}).then(f=>f.text()).then(function(f){ThemifyUpdater.hideAlert();delete b.dataset.loading;b.parentNode.replaceChild(g.createTextNode(themify_upgrader.activated),b)}).catch(function(f){ThemifyUpdater.hideAlert("error");delete b.dataset.loading})))});return h},updateThemeBtn:function(){d(".upgrade-theme-button").on("click",
function(a){a.preventDefault();a.stopPropagation();const e=this;if(!e.dataset.loading){a=JSON.parse(atob(d(a.target).data("install")));var h=d("#themeversiontoreinstall").val(),c=a.url+"?",b=h?parseInt(h[0].toString().trim()):null;if(!(null!==b&&7>b&&"undefined"!==typeof themify_vars&&7<=parseInt(themify_vars.version[0].toString().trim()))||confirm(themify_upgrader.v7_message)){delete a.url;for(var f in a)c+=f+"="+a[f]+"&";c+="themify-theme=1&version="+h;ThemifyUpdater.showAlert();fetch(c,{headers:new Headers({"X-Requested-With":"XMLHttpRequest"})}).then(k=>
k.text()).then(function(k){ThemifyUpdater.hideAlert();delete e.dataset.loading;n.location.reload()}).catch(function(k){ThemifyUpdater.hideAlert("error");delete e.dataset.loading})}}})}};ThemifyUpdater.events()})(jQuery,window,document);
